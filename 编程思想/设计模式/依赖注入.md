---
tags:
  - 设计模式
aliases:
time: 2025-12-29
---
# C# 依赖注入（Dependency Injection, DI）

## 什么是依赖注入？

**依赖注入**是一种设计模式，用于实现**控制反转（IoC）**，将对象的创建和绑定从其内部转移到外部容器管理。它主要解决以下问题：

1. **解耦**：降低类之间的耦合度
    
2. **可测试性**：便于单元测试，可轻松替换依赖
    
3. **可维护性**：集中管理依赖关系
    
4. **可扩展性**：易于添加新实现
## 实现方式:
# 1. **构造函数注入**（最常用）
```
// 1. 定义接口
public interface IEmailService
{
    void SendEmail(string message);
}
// 2. 实现接口
public class EmailService : IEmailService
{
    public void SendEmail(string message)
    {
        Console.WriteLine($"发送邮件：{message}");
    }
}
// 3. 依赖注入（构造函数注入）
public class OrderService
{
    private readonly IEmailService _emailService;
    // 构造函数注入依赖
    public OrderService(IEmailService emailService)
    {
        _emailService = emailService;
    }
    public void CreateOrder()
    {
        // 业务逻辑
        _emailService.SendEmail("订单创建成功");
    }
}
// 4. 组合根（手动装配）
public class Program
{
    static void Main()
    {
        // 手动创建依赖
        IEmailService emailService = new EmailService();
        // 注入依赖
        OrderService orderService = new OrderService(emailService);
        orderService.CreateOrder();
    }
}
```
# 2. **属性注入**

# 3. **方法注入**